pathways = ["Apoptosis_signaling", "B_cell_activation",
            "Beta3_adrenergic_rec", "Cadherin_signaling",
            "Hedgehog_signaling", "Insulin_IGF",
            "Interleukin_signaling", "Notch_signaling",
            "PDGF_signaling", "Ras", "T_cell_activation",
            "Toll_signaling", "Wnt_signaling", "p38_MAPK",
            "Nicotinic_acetylchol", "Fas_signaling",
            "FGF_signaling", "Interferon_gamma_signaling",
            "JAK_STAT_signaling", "VEGF_signaling"]

rule all:
    input:
        "intermediate/9606.protein.links.full.v12.0.txt",
        expand([
            "processed/{pathway}/{pathway}_node_prizes.txt",
            "processed/{pathway}/{pathway}_gs_edges.txt",
            "processed/{pathway}/{pathway}_gs_nodes.txt"
        ], pathway=pathways)

rule process_panther_pathway:
    input: "raw/pathway-data/{pathway}.txt"
    output:
        [
            "intermediate/{pathway}/EDGES.txt",
            "intermediate/{pathway}/NODES.txt",
            "intermediate/{pathway}/TARGETS.txt",
            "intermediate/{pathway}/SOURCES.txt",
            "intermediate/{pathway}/PRIZES.txt"
        ]
    shell:
        "uv run src/process_panther_pathway.py {wildcards.pathway}"

rule make_spras_compatible:
    input:
        [
            "intermediate/{pathway}/EDGES.txt",
            "intermediate/{pathway}/NODES.txt",
            "intermediate/{pathway}/TARGETS.txt",
            "intermediate/{pathway}/SOURCES.txt",
            "intermediate/{pathway}/PRIZES.txt"
        ]
    output:
        [
            "processed/{pathway}/{pathway}_node_prizes.txt",
            "processed/{pathway}/{pathway}_gs_edges.txt",
            "processed/{pathway}/{pathway}_gs_nodes.txt"
        ]
    shell:
        "uv run src/SPRAS_compatible_files.py {wildcards.pathway}"

rule download_interactome:
    output:
        "intermediate/9606.protein.links.full.v12.0.txt.gz"
    shell:
        "uv run src/download_interactome.py"

rule unpack_interactome:
    input:
        "intermediate/9606.protein.links.full.v12.0.txt.gz"
    output:
        "intermediate/9606.protein.links.full.v12.0.txt"
    shell:
        "gunzip intermediate/9606.protein.links.full.v12.0.txt.gz"