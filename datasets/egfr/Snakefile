rule all:
    input:
        "processed/egfr-prizes.txt"

rule prizes:
    # Make the SPRAS adjustments
    input:
        "processed/egfr-prizes-unSPRASed.txt"
    output:
        "processed/egfr-prizes.txt"
    shell:
        "uv run scripts/process_prizes.py --input={input} --output={output}"

rule prizes_unsprased:
    input:
        "download/tps_input_pvals_first.tsv",
        "download/tps_input_pvals_prev.tsv",
        "raw/peptide-mapping.tsv"
    output:
        # We haven't made the final SPRAS adjustments yet.
        "processed/egfr-prizes-unSPRASed.txt"
    shell:
        "uv run scripts/generate_prizes.py " \
            "--firstfile=download/tps_input_pvals_first.tsv " \
            "--prevfile=download/tps_input_pvals_prev.tsv " \
            "--mapfile=raw/peptide-mapping.tsv " \
            "--outfile={output}"

rule get_prize_files:
    output:
        "download/tps_input_pvals_first.tsv",
        "download/tps_input_pvals_prev.tsv"
    shell:
        "uv run scripts/fetch-tps-data.py"
